<odoo>
    <data>
    <record model="ir.ui.view" id="view_item_request_form" >
        <field name="name">item.request.form</field>
        <field name="model">item.request</field>
        <field name="arch" type="xml">
            <form string="item Request">
                <header>
                    <button name="button_draft"
                            states="to_approve,leader_approved,rejected"
                            string="Reset"
                            type="object"
                            groups="stock.group_stock_manager"/>
                    <button name="button_to_approve" states="draft"
                            string="Request approval" type="object"
                            class="oe_highlight"/>
                    <button name="button_leader_approved"
                            string="Confirm"
                            type="object"
                            class="oe_highlight"
                            groups="base.group_user"
                            attrs="{'invisible': [('can_leader_approved', '=', False)]}"/>

                    <button name="button_manager_approved"
                            string="Manager Approve"
                            type="object"
                            class="oe_highlight"
                           attrs="{'invisible': [('can_manager_approved', '=', False)]}"/>
<!--                     <button name="confirm_delivered"-->
<!--                            string="Confirm Receiving"-->
<!--                            type="object"-->
<!--                            class="oe_highlight"-->
<!--                           attrs="{'invisible': [('can_delivered', '=', False)]}"-->
<!--                    />-->

                    <button name="button_rejected"
                            string="Reject"
                            type="object"
                            attrs="{'invisible': [('can_reject', '=', False)]}"
                    />

<!--                    <button string="Issuing" states="approved" name="make_item_request" type="object"-->
<!--                        context="{'default_product_ids': line_ids}"-->
<!--                        groups="stock.group_stock_user,stock.group_stock_manager"-->
<!--                    />-->
                    <field
                        name="state"
                        widget="statusbar"  attrs="{'readonly':[('state','!=',False)]}"
                        statusbar_visible="draft,to_approve,leader_approved,approved,done"
                        statusbar_colors='{"approved":"blue"}'
                    />
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box"  groups="stock.group_stock_user">
                        <button type="object" name="action_view_picking" class="oe_stat_button" icon="fa-truck" attrs="{'invisible':[('state', 'in', ('draft','to_approve','leader_approved','manager_approved')),('picking_ids','=',[])]}">
                            <field name="picking_count" widget="statinfo" string="Shipment" help="Incoming Shipments"/>
                            <field name="picking_ids" invisible="1"/>
                        </button>
                    </div>

                    <div class="oe_edit_only">
                        <label for="name" class="oe_inline" />
                    </div>
                    <h1>
                        <field name="is_editable" invisible="1" />
                        <field name="can_reject" invisible="1" />
                        <field name="can_leader_approved" invisible="1" />
                        <field name="can_manager_approved" invisible="1" />
                        <field
                            name="name"
                            class="oe_inline"
                           attrs="{'readonly':[('name','!=','New')],'invisible':[('name','=','New')]}"
                        />
                    </h1>
                    <group>
                        <group>
                            <field
                                name="requested_by"
                               readonly ="1"
                            />
                            <field
                                name="assigned_to"
                               readonly ="1"
                            />
                            <field
                                name="department_id"
                               readonly ="1"
                            />
                        </group>
                        <group>
                             <field
                                name="date_start"
                                 attrs="{'readonly':[('date_start','!=',False)]}"
                            />

                            <field
                                name="origin"
                                class="oe_inline"
                                attrs="{'readonly': [('is_editable','=', False)]}"
                            />
                             <field
                                name="location_id"
                                attrs="{'readonly': [('is_editable','=', False)]}"
                            />

                        </group>
                        <group>
                               <field
                                name="description"
                                attrs="{'readonly': [('is_editable','=', False)]}"
                            />

                            <field
                                name="company_id"
                                groups="base.group_multi_company"
                                widget="selection"
                                attrs="{'readonly': [('is_editable','=', False)]}" invisible="1"
                            />
                        </group>
                    </group>
 <notebook>
                        <page string="Products">
                            <field name="line_ids" attrs="{'invisible': [('can_manager_approved', '=', True)],'readonly': [('is_editable','=', False)]}" >
                                <tree>
                                    <field name="product_id" />
                                    <field name="lot_id" />
                                    <field name="product_qty" />
                                    <field name="qty" />
                                    <field name="qty_in_progress" attrs="{'column_invisible': [('parent.state','not in', ('done','approved'))]}"/>
                                    <field name="qty_done" attrs="{'column_invisible': [('parent.state','not in', ('done','approved'))]}"/>
                                    <field name="qty_cancelled" attrs="{'column_invisible': [('parent.state','not in', ('done','approved'))]}"/>
                                    <field name="product_uom_id" groups="uom.group_uom" />
                                    <field name="is_editable" invisible="1" />

                                </tree>
                                <form>
                                    <sheet>
                                        <group name="main">
                                            <group>
                                                <field
                                                    name="is_editable"
                                                    invisible="1"
                                                />
                                                <field
                                                    name="product_id"  options="{'no_create_edit':True, 'no_create':True, 'no_open':True}"
                                                    attrs="{'readonly': [('is_editable','=', False)]}"
                                                />
                                               <field name="lot_id"  options="{'no_create_edit':True, 'no_create':True, 'no_open':True}" attrs="{'readonly': [('is_editable','=',False)]}"/>

                                                <field
                                                    name="location_id"  options="{'no_create_edit':True, 'no_create':True, 'no_open':True}"
                                                    attrs="{'readonly': [('is_editable','=', False)]}" invisible="1"
                                                />

                                                <label
                                                    for="product_qty"
                                                    attrs="{'readonly': [('is_editable','=', False)]}"
                                                />
                                                <div>
                                                    <field
                                                        name="product_qty"
                                                        class="oe_inline"
                                                        attrs="{'readonly': [('is_editable','=', False)]}"
                                                    />
                                                    <field
                                                        name="product_uom_id"
                                                        groups="uom.group_uom"
                                                        class="oe_inline"
                                                        attrs="{'readonly': [('is_editable','=', False)]}"  options="{'no_create_edit':True, 'no_create':True, 'no_open':True}"
                                                    />
                                                </div>

                                                    <field
                                                        name="qty" invisible="1"
                                                    />


                                            </group>
                                        </group>

                                        <group name="quantities" string="Tracking">
                                            <group>
                                                <field name="qty_in_progress" />
                                                <field name="qty_done" />
                                                <field name="qty_cancelled" />
                                            </group>
                                        </group>
                                        <notebook>

                                        </notebook>
                                    </sheet>
                                </form>
                            </field>
                            <field name="manager_line_ids" attrs="{'invisible': [('can_manager_approved', '=', False)]}">
                                <tree create="0" delete="0"  >
                                    <field name="product_id" />
                                                                        <field name="lot_id" />

                                    <field name="product_qty" />
                                    <field name="qty" />

                                    <field  name="product_uom_id" groups="uom.group_uom" />

                                    <field name="date_required" />


                                    <field name="is_editable" invisible="1" />

                                </tree>
                                <form>
                                    <sheet>
                                        <group name="main">
                                            <group>
                                                <field name="is_editable" invisible="1"  />
                                                <field name="product_id" attrs="{'readonly': [('is_editable','=', False)]}"  />
                                                <field name="lot_id" attrs="{'readonly': [('is_editable','=', False)]}"/>

                                                <field name="location_id"  attrs="{'readonly': [('is_editable','=', False)]}" />

                                                <label for="product_qty" attrs="{'readonly': [('is_editable','=', False)]}" />
                                                <div>
                                                    <field name="product_qty" class="oe_inline" attrs="{'readonly': [('is_editable','=', False)]}"
                                                    />
                                                    <field name="product_uom_id" groups="uom.group_uom" class="oe_inline" attrs="{'readonly': [('is_editable','=', False)]}"
                                                    />
                                                </div>
                                                  <field name="qty" />



                                            </group>
                                        </group>

                                        <group name="quantities" string="Tracking">
                                            <group>
                                                <field name="qty_in_progress" />
                                                <field name="qty_done" />
                                                <field name="qty_cancelled" />
                                            </group>
                                        </group>
                                        <notebook>

                                        </notebook>
                                    </sheet>
                                </form>
                            </field>
                        </page>
                    </notebook>

                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>
     <record id="view_item_request_tree" model="ir.ui.view">
        <field name="name">item.request.tree</field>
        <field name="model">item.request</field>
        <field name="arch" type="xml">
            <tree
                decoration-bf="message_needaction==True"
                decoration-info="state in ('draft','to_approve')"
                decoration-muted="state in ('rejected')"
                string="item Request"
            >
                <field name="message_needaction" invisible="1" />
                <field name="name" />
                <field name="date_start" />
                <field name="requested_by" />
                <field
                    name="company_id"
                    groups="base.group_multi_company"
                    widget="selection"
                />
                <field name="origin" />
                <field name="state" />
            </tree>
        </field>
    </record>

        <record id="view_item_request_line_tree" model="ir.ui.view">
        <field name="name">item.request.tree</field>
        <field name="model">item.request.line</field>
        <field name="arch" type="xml">
           <tree create="0" edit="0">
               <field name="product_id" />
                                    <field name="lot_id" />
                                    <field name="product_qty" />
                                    <field name="qty" />
                                    <field name="qty_in_progress" />
                                    <field name="qty_done"/>
                                    <field name="qty_cancelled" />
                                    <field name="product_uom_id" groups="uom.group_uom" />
                                </tree>
        </field>
    </record>
    <record model="ir.actions.act_window" id="item_request_form_action">
        <field name="name">Item Requests</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">item.request</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{"search_default_requested_by":uid}</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
            Click to start a new item request process.
          </p>
            <p>
            A item request is an instruction to Purchasing to procure
            a certain quantity of materials services, so that they are
            available at a certain point in time.
          </p>
        </field>
    </record>
   <menuitem
        id="menu_item_request"
        name="Item Request"
        action ="item_request_form_action"
    />
    </data>
</odoo>