<odoo>
    <record id="view_stock_move_line_operation_tree_expiry" model="ir.ui.view">
        <field name="name">stock.move.line</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="product_expiry.view_stock_move_line_operation_tree_expiry"/>
        <field name="arch" type="xml">

            <xpath expr="//field[@name='expiration_date']" position="after">
                <field name="box_no" groups="stock.group_production_lot"

                       invisible="not context.get('show_lots_text')" force_save="1"
                       required=" context.get('show_lots_text')"/>
                <field name="box_qty" groups="stock.group_production_lot" force_save="1"
                       invisible="not context.get('show_lots_text')" required=" context.get('show_lots_text')"/>
                <field name="suplier_lot" groups="stock.group_production_lot" force_save="1"
                       invisible="not context.get('show_lots_text')" required=" context.get('show_lots_text')"/>
                <field name="attachment_ids" groups="stock.group_production_lot" widget="many2many_binary"
                       force_save="1" invisible="not context.get('show_lots_text')"
                       required=" context.get('show_lots_text')"/>
                <field name="balet_ids" groups="stock.group_production_lot" widget="many2many_tags"
                       invisible="not context.get('show_lots_text')" force_save="1"/>
            </xpath>
            <xpath expr="//field[@name='expiration_date']" position="before">
                <field name="prod_date" force_save="1"
                       attrs="{'column_invisible': ['|', ('parent.use_expiration_date', '!=', True), ('parent.picking_code', '!=', 'incoming')],                     'readonly': [('picking_type_use_existing_lots', '=', True)],                 }"/>
            </xpath>
            <xpath expr="//field[@name='expiration_date']" position="replace">
                <field name="expiration_date" force_save="1" attrs="{
                    'column_invisible': [('parent.use_expiration_date', '!=', True)],
                    'readonly': [('picking_type_use_existing_lots', '=', True)],
                }"/>
            </xpath>

        </field>
    </record>
    <record id="view_stock_move_line_operation_tree_expiry2" model="ir.ui.view">
        <field name="name">stock.move.line</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="product_expiry.view_stock_move_line_detailed_operation_tree_expiry"/>
        <field name="arch" type="xml">

            <xpath expr="//field[@name='expiration_date']" position="replace">
                <field name="expiration_date" force_save="1"
                       attrs="{'readonly': [('picking_type_use_existing_lots', '=', True)],}"/>
            </xpath>

        </field>
    </record>
    <record id="view_stock_move_line_operation_tree_lot_name" model="ir.ui.view">
        <field name="name">stock.move.line</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_stock_move_line_operation_tree"/>
        <field name="arch" type="xml">

            <xpath expr="//field[@name='lot_name']" position="replace">
                <field name="lot_name" widget="text" groups="stock.group_production_lot"
                       placeholder="Write your SN/LN one by one or copy paste a list."
                       invisible="not context.get('show_lots_text')" force_save="1"/>
            </xpath>


        </field>
    </record>
    <record id="view_move_form_expiry_production" model="ir.ui.view">
        <field name="name">stock.production.lot.inherit.form</field>
        <field name="model">stock.production.lot</field>
        <field name="inherit_id" ref="product_expiry.view_move_form_expiry"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='expiration_date']" position="before">
                <field name="prod_date"/>
            </xpath>
            <xpath expr="//page[@name='expiration_dates']" position="after">
                <page string="Lot Information" name="lot_info"
                      attrs="{'invisible': [('use_expiration_date', '=', False)]}">
                    <field name="use_expiration_date" invisible="1"/>
                    <group>
                        <group>
                            <field name="suplier_lot"/>
                            <field name="box_qty"/>
                            <field name="balet_ids" widget="many2many_tags"/>

                        </group>
                        <group>
                            <field name="box_no"/>

                            <field name="attachment_ids" widget="many2many_binary"/>

                        </group>
                    </group>
                </page>
            </xpath>

        </field>
    </record>


    <record id="view_wizard_balet_stock" model="ir.ui.view">
        <field name="name">Pallet Change</field>
        <field name="model">balet.change</field>
        <field name="arch" type="xml">
            <form string="">
                <p class="oe_gray">
                </p>
                <group>

                    <field name="lot_id"/>
                    <field name="balet_ids" widget="many2many_tags"/>
                    <field name="balet_new_ids" widget="many2many_tags"/>

                </group>
                <footer>
                    <button name="confirm"
                            string="Confirm "
                            type="object"
                            class="btn-primary"/>
                    <button string="Cancel" class="btn-default" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    <record id="view_wizard_balet_stock2s" model="ir.ui.view">
        <field name="name">Pallet Change</field>
        <field name="model">balet.change</field>
        <field name="arch" type="xml">
            <form string="" edit="0" create="0">
                <p class="oe_gray">
                </p>
                <group>
                    <field name="create_date"/>

                    <field name="lot_id"/>
                    <field name="create_uid"/>
                    <field name="balet_new_ids" widget="many2many_tags"/>

                </group>

            </form>
        </field>
    </record>
    <record id="view_wizard_balet_stock_tree" model="ir.ui.view">
        <field name="name">Pallet</field>
        <field name="model">balet.change</field>
        <field name="arch" type="xml">
            <tree edit="0" create="0">
                <field name="create_date"/>

                <field name="lot_id"/>
                <field name="create_uid"/>
                <field name="balet_new_ids" widget="many2many_tags"/>
            </tree>
        </field>
    </record>

    <record id="action_wizard_balet_change" model="ir.actions.act_window">
        <field name="name">Pallet Change</field>
        <field name="res_model">balet.change</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="view_wizard_balet_stock"/>
        <field name="target">new</field>
    </record>
    <record id="action_balet_change_location" model="ir.actions.act_window">
        <field name="name">Pallet Change</field>
        <field name="res_model">balet.change</field>
        <field name="view_mode">tree,form</field>
        <field name="view_ids"
               eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('inventory_update.view_wizard_balet_stock_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('inventory_update.view_wizard_balet_stock2s')})]"/>

        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                <!-- Add Text Here -->
            </p>
            <p>
                <!-- More details about what a user can do with this object will be OK -->
            </p>
        </field>
    </record>
    <record model="ir.actions.act_window" id="lot_balet_change">
        <field name="name">Pallet</field>
        <field name="domain">[('lot_id' ,'in' ,[active_id])]</field>
        <field name="res_model">balet.change</field>
        <field name="view_ids"
               eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('inventory_update.view_wizard_balet_stock_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('inventory_update.view_wizard_balet_stock2s')})]"/>
    </record>
    <record id="view_production_lot_form3" model="ir.ui.view">
        <field name="model">stock.production.lot</field>
        <field name="inherit_id" ref="stock.view_production_lot_form"/>
        <field name="arch" type="xml">
            <div name="button_box" position="inside">
                <button class="oe_inline oe_stat_button" type="action" name="%(lot_balet_change)d"
                        string="Balet History" icon="fa-history" attrs="{'invisible': [('history_ids','=',[])]}">
                    <field name="history_ids" invisible="1"/>
                </button>

            </div>
        </field>

    </record>
    <menuitem
            id="menu_action_balet_change"
            action="action_wizard_balet_change"
            sequence="105"
            parent="stock.menu_stock_inventory_control"
            groups="stock.group_stock_user"
    />

    <record model="ir.ui.view" id="view_stock_quant_tree_inherit">
        <field name="name">stock.quant.tree.editable.inherit</field>
        <field name="model">stock.quant</field>
        <field name="inherit_id" ref="stock.view_stock_quant_tree"></field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='lot_id']" position="after">
                <field name="suplier_lot"/>
                <field name="balet_ids" widget="many2many_tags"/>

            </xpath>
        </field>
    </record>
    <record model="ir.ui.view" id="view_stock_quant_search_inherit">
        <field name="name">stock.quant.tree.editable.inherit</field>
        <field name="model">stock.quant</field>
        <field name="inherit_id" ref="stock.quant_search_view"></field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='lot_id']" position="after">
                <field name="suplier_lot"/>
                <field name="balet_ids"/>

            </xpath>
        </field>
    </record>
    <record model="ir.ui.view" id="view_stock_quant_form_inherit">
        <field name="name">stock.quant.tree.editable.inherit</field>
        <field name="model">stock.quant</field>
        <field name="inherit_id" ref="stock.view_stock_quant_form"></field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='lot_id']" position="after">
                <field name="suplier_lot"/>
                <field name="balet_ids" widget="many2many_tags"/>
            </xpath>
        </field>
    </record>
</odoo>